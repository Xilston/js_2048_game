function e(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var a=document.getElementById("game-table").getElementsByTagName("tr"),s=document.getElementById("start"),n=document.getElementById("message-start"),l=document.getElementById("message-win"),o=document.getElementById("message-lose"),v=document.getElementById("game-score"),u=function(){function t(){e(this,t),this.size=4,this.chipsArray=[],this.status=!1,this.score=0,this.win=!1,this.gameOver=!1}return r(t,[{key:"startGame",value:function(){this.status=!0,this.chipsArray=[],this.score=0,this.win=!1,this.gameOver=!1;for(var e=0;e<this.size;e++){for(var t=[],r=0;r<this.size;r++)t.push(new h(0));this.chipsArray.push(t)}for(var i=0;i<2;i++)this.addChip(new h(d()))}},{key:"addChip",value:function(e){var t=function(e){for(var t=[],r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++){var a={x:null,y:null};0===e[r][i].value&&(a.x=i,a.y=r,t.push(a))}return t}(this.chipsArray);if(t.length){var r,i=(r=t.length,t[Math.floor(Math.random()*(r-0)+0)]),a=i.x,s=i.y;this.chipsArray[s][a]=e}else console.log("no free space")}},{key:"restart",value:function(){this.startGame()}},{key:"moveLeft",value:function(){for(var e=this.chipsArray,t=!1,r=0;r<e.length;r++)for(var i=1;i<e.length;i++){var a=e[r][i];if(0!==a.value){var s=i-m(i,e[r],"left");!0===this.moveTiles(a,e[r][s])&&!1===t&&(t=!0)}}!0===t?this.addChip(new h(d())):this.isGameOver(),this.resetTiles()}},{key:"moveUp",value:function(){for(var e=this.chipsArray,t=!1,r=1;r<e.length;r++)for(var i=0;i<e.length;i++){var a=e[r][i];if(0!==a.value){var s=r-m({y:r,x:i},e,"up");!0===this.moveTiles(a,e[s][i])&&!1===t&&(t=!0)}}!0===t?this.addChip(new h(d())):this.isGameOver(),this.resetTiles()}},{key:"moveDown",value:function(){for(var e=this.chipsArray,t=!1,r=this.size-2;r>=0;r--)for(var i=0;i<e.length;i++){var a=e[r][i];if(0!==a.value){var s=r+m({y:r,x:i},e,"down");!0===this.moveTiles(a,e[s][i])&&!1===t&&(t=!0)}}!0===t?this.addChip(new h(d())):this.isGameOver(),this.resetTiles()}},{key:"moveRight",value:function(){for(var e=this.chipsArray,t=!1,r=0;r<this.size;r++)for(var i=this.size-2;i>=0;i--){var a=e[r][i];if(0!==a.value){var s=i+m(i,e[r],"right");!0===this.moveTiles(a,e[r][s])&&!1===t&&(t=!0)}}!0===t?this.addChip(new h(d())):this.isGameOver(),this.resetTiles()}},{key:"moveTiles",value:function(e,t){if(e!==t){var r=t.merge(e);return f.score+=r,2048===r&&(this.win=!0),!0}return!1}},{key:"isGameOver",value:function(){for(var e=this,r=function(r){for(var s=0;s<e.size;s++){var n=function(i){var s=e.chipsArray[r][i];if(!1===(a=t.getClosestTiles(r,i,e.chipsArray).every(function(e){return e.value!==s.value})))return e.gameOver=!1,{v:a}}(s);if("object"===i(n))return{v:n.v}}},a=!0,s=0;s<this.size;s++){var n=r(s);if("object"===i(n))return n.v}return this.gameOver=!0,!0}},{key:"resetTiles",value:function(){for(var e=0;e<this.size;e++)for(var t=0;t<this.size;t++)this.chipsArray[e][t].resetMerge()}}],[{key:"getClosestTiles",value:function(e,t,r){var i=[];return t>0&&i.push(r[e][t-1]),t<r[0].length-1&&i.push(r[e][t+1]),e>0&&i.push(r[e-1][t]),e<r.length-1&&i.push(r[e+1][t]),i}}]),t}(),h=function(){function t(r){e(this,t),this.value=r,this.ableToUnion=!0}return r(t,[{key:"merge",value:function(e){var t=0;return(0===this.value||this.value===e.value)&&(this.value>0&&e.value>0&&(t+=this.value+e.value,this.ableToUnion=!1),this.value+=e.value,e.value=0),t}},{key:"resetMerge",value:function(){this.ableToUnion=!0}}]),t}(),f=new u;function c(){for(var e=f.chipsArray,t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++){var i=a[t].children[r],s=e[t][r],n=2*i.innerText===s.value?"merged ":"";0!==s.value?(i.innerHTML=s.value,i.className="field-cell ".concat(n,"field-cell--").concat(s.value)):(i.innerHTML="",i.className="field-cell")}v.innerText=f.score,f.win&&l.classList.remove("hidden"),f.gameOver&&o.classList.remove("hidden")}function d(e){return 0===e?0:[2,2,2,2,2,2,2,2,2,4][Math.floor(10*Math.random())]}function m(e,t,r){var i=0;if("left"===r)for(var a=e-1;a>=0;a--)if(0===t[a].value)i++;else{if(t[a].value!==t[e].value||!t[a].ableToUnion)return i;i++}if("up"===r)for(var s=e.y,n=e.x,l=s-1;l>=0;l--)if(0===t[l][n].value)i++;else{if(t[l][n].value!==t[s][n].value||!t[l][n].ableToUnion)return i;i++}if("down"===r)for(var o=e.y,v=e.x,u=o+1;u<t.length;u++)if(0===t[u][v].value)i++;else{if(t[u][v].value!==t[o][v].value||!t[u][v].ableToUnion)return i;i++}if("right"===r)for(var h=e+1;h<t.length;h++)if(0===t[h].value)i++;else if(t[h].value===t[e].value&&t[h].ableToUnion)i++;else break;return i}s.addEventListener("click",function(){!1===f.status?(f.startGame(),c(),n.classList.add("hidden"),s.classList.remove("start"),s.classList.add("restart"),s.innerText="restart"):(function(){for(var e=0;e<a.length;e++)for(var t=0;t<a.length;t++){var r=a[e].children[t];r.innerHTML="",r.className="field-cell"}}(),f.restart(),c(),l.classList.add("hidden"),o.classList.add("hidden"))}),document.addEventListener("keydown",function(e){if(!0===f.status)switch(e.key){case"ArrowUp":f.moveUp(),c();break;case"ArrowDown":f.moveDown(),c();break;case"ArrowLeft":f.moveLeft(),c();break;case"ArrowRight":f.moveRight(),c()}});
//# sourceMappingURL=index.ed859869.js.map
